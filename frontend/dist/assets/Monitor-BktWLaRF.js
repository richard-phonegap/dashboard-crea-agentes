import{d as h,o as x,a2 as y,c as r,b as t,t as i,n as _,F as k,r as w,h as u,a1 as M,i as T,p as c,a as d,_ as C}from"./index-CSrpo0t2.js";import{m as D}from"./marked.esm-DKjyhwJX.js";const I={key:0,class:"monitor"},L={class:"monitor-header animate-fade-in"},$={class:"text-muted"},E={class:"flex gap-12 items-center"},R={class:"monitor-grid"},S={class:"stats-row animate-fade-in"},V={class:"stat-card card"},A={class:"stat-value"},B={class:"stat-card card"},F={class:"stat-value"},N={class:"stat-card card"},j={class:"stat-value"},H={class:"card animate-fade-in"},O={class:"log-container"},P={class:"log-ts"},q={key:0,class:"log-agent"},z={class:"log-text"},J={key:0,class:"text-muted text-center",style:{padding:"20px"}},G={key:0,class:"card animate-fade-in"},K=["innerHTML"],Q={key:1,class:"loading-state"},U=h({__name:"Monitor",setup(W){const m=M(),a=T(null),v=c(()=>{var e;if(!((e=a.value)!=null&&e.logs))return[];try{return JSON.parse(a.value.logs)}catch{return[]}}),p=c(()=>{var e;switch((e=a.value)==null?void 0:e.status){case"completed":return"badge-success";case"failed":return"badge-error";case"running":return"badge-info";default:return"badge-warning"}}),g=c(()=>{var n,l;if(!((n=a.value)!=null&&n.started_at)||!((l=a.value)!=null&&l.completed_at))return"‚Äî";const e=new Date(a.value.started_at).getTime(),s=new Date(a.value.completed_at).getTime(),o=Math.round((s-e)/1e3);return o<60?`${o}s`:`${Math.floor(o/60)}m ${o%60}s`});x(async()=>{const e=m.params.runId,s=m.query.crewId;if(s&&e){const{runsApi:o}=await y(async()=>{const{runsApi:n}=await import("./api-CMOejpBo.js");return{runsApi:n}},[]);a.value=await o.get(s,e)}});function f(e){return new Date(e).toLocaleTimeString("es",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function b(e){return D.parse(e)}return(e,s)=>{var o;return a.value?(d(),r("div",I,[t("div",L,[t("div",null,[s[1]||(s[1]=t("h1",null,"Monitor de Ejecuci√≥n",-1)),t("p",$,"Run ID: "+i(a.value.id.slice(0,8))+"...",1)]),t("div",E,[t("span",{class:_(["badge",p.value])},i(a.value.status),3),t("button",{class:"btn btn-secondary",onClick:s[0]||(s[0]=n=>e.$router.back())},"‚Üê Volver")])]),t("div",R,[t("div",S,[t("div",V,[t("div",A,i(a.value.tokens_used),1),s[2]||(s[2]=t("div",{class:"stat-label text-muted text-sm"},"Tokens",-1))]),t("div",B,[t("div",F,"$"+i((o=a.value.cost)==null?void 0:o.toFixed(4)),1),s[3]||(s[3]=t("div",{class:"stat-label text-muted text-sm"},"Costo",-1))]),t("div",N,[t("div",j,i(g.value),1),s[4]||(s[4]=t("div",{class:"stat-label text-muted text-sm"},"Duraci√≥n",-1))])]),t("div",H,[s[5]||(s[5]=t("h3",{style:{"margin-bottom":"12px"}},"üìã Logs de Ejecuci√≥n",-1)),t("div",O,[(d(!0),r(k,null,w(v.value,(n,l)=>(d(),r("div",{key:l,class:_(["log-line","log-"+n.level])},[t("span",P,i(f(n.timestamp)),1),n.agent?(d(),r("span",q,"["+i(n.agent)+"]",1)):u("",!0),t("span",z,i(n.message),1)],2))),128)),v.value.length===0?(d(),r("div",J," Sin logs disponibles ")):u("",!0)])]),a.value.result?(d(),r("div",G,[s[6]||(s[6]=t("h3",{style:{"margin-bottom":"12px"}},"üìÑ Resultado",-1)),t("div",{class:"result-body",innerHTML:b(a.value.result)},null,8,K)])):u("",!0)])])):(d(),r("div",Q,[...s[7]||(s[7]=[t("div",{class:"animate-pulse"},"‚è≥ Cargando...",-1)])]))}}}),Z=C(U,[["__scopeId","data-v-4ef0717a"]]);export{Z as default};
